{"map":"{\"version\":3,\"sources\":[\"webpack/bootstrap\",\"/Users/didi/Downloads/test-xevent/src/XPTracker.js\",\"/Users/didi/Downloads/test-xevent/src/XPStream.js\",\"/Users/didi/Downloads/test-xevent/src/XPStashTracker.js\",\"/Users/didi/Downloads/test-xevent/src/XPRegisterTrackers.js\",\"/Users/didi/Downloads/test-xevent/src/index.js\",\"/Users/didi/Downloads/test-xevent/src/XPEvent.js\",\"/Users/didi/Downloads/test-xevent/src/XPEventManager.js\"],\"names\":[\"installedModules\",\"__webpack_require__\",\"moduleId\",\"exports\",\"module\",\"i\",\"l\",\"modules\",\"call\",\"m\",\"c\",\"d\",\"name\",\"getter\",\"o\",\"Object\",\"defineProperty\",\"enumerable\",\"get\",\"r\",\"Symbol\",\"toStringTag\",\"value\",\"t\",\"mode\",\"__esModule\",\"ns\",\"create\",\"key\",\"bind\",\"n\",\"object\",\"property\",\"prototype\",\"hasOwnProperty\",\"p\",\"s\",\"[object Object]\",\"this\",\"index\",\"descriptions\",\"completion\",\"breaker\",\"resendEventCb\",\"descriptor\",\"push\",\"event\",\"timestamp\",\"Date\",\"parse\",\"self\",\"length\",\"onResendEvent\",\"streams\",\"currentDimension\",\"getId\",\"indexOf\",\"systemTrackers\",\"tracker\",\"receiveEvent\",\"bufferEvents\",\"Array\",\"currentTrackers\",\"reSendEvent\",\"console\",\"log\",\"bufferEvent\",\"trackers\",\"dimension\",\"trackerGroup\",\"reset\",\"EventTracker\",\"super\",\"stashEventMap\",\"alias\",\"StashEventTracker\",\"isTest\",\"registerTrackers\",\"stream\",\"xpanel_sw_tracker\",\"addDescriptor\",\"fulfill\",\"addCompletion\",\"triggerReport\",\"JSON\",\"stringify\",\"pullup_tracker\",\"getEventAttr\",\"addResendEventCb\",\"setTime\",\"setId\",\"xpanel_sw_time_tracker\",\"putStashEvent\",\"duration\",\"getTime\",\"getStashEvent\",\"putAttr\",\"xpanel_half_reveal_sw_tracker\",\"xpanel_card_ck_tracker\",\"xpanel_button_ck_tracker\",\"jsonData\",\"xpEventManager\",\"registerSystemTracker\",\"registerTracker\",\"getDimension\",\"unregisterTracker\",\"dimensionChangeTracker\",\"pushVCTracker\",\"changeDimensionAndResetTrackers\",\"xpEventId\",\"time\",\"attrsMap\",\"eventAttrsMap\",\"initStream\",\"initTrackers\",\"ostype\",\"sendEvent\",\"objs\",\"eval\",\"innerEvent\",\"Event\",\"init\",\"osType\",\"newStream\"],\"mappings\":\"aACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,EAAAA,EAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,QAAAA,OAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,aAAA,CAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,GAAA,EAAAE,GAAA,iBAAAF,GAAAA,GAAAA,EAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,UAAA,CAAyCT,YAAA,EAAAK,MAAAA,IACzC,EAAAE,GAAA,iBAAAF,EAAA,IAAA,IAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,GAAAA,EAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,EAAAA,EAAAmC,EAAA,mBCbAhC,EAAAD,QArEA,MACAkC,YAAAzB,GACA0B,KAAA1B,KAAAA,EACA0B,KAAAC,MAAA,EACAD,KAAAE,aAAA,GACAF,KAAAG,WAAA,KACAH,KAAAI,QAAA,KACAJ,KAAAK,cAAA,KAEAN,cAAAO,GAEA,OADAN,KAAAE,aAAAK,KAAAD,GACAN,KAEAD,WAAAK,GAEA,OADAJ,KAAAI,QAAAA,EACAJ,KAEAD,cAAAI,GAEA,OADAH,KAAAG,WAAAA,EACAH,KAEAD,iBAAAM,GAEA,OADAL,KAAAK,cAAAA,EACAL,KAGAD,QACAC,KAAAC,MAAA,EAGAF,cAAAS,GAEA,IAAAC,EAAAC,KAAAC,MAAA,IAAAD,MACA,OAAAV,KAAAK,cACAL,KAAAK,cAAAG,EAAAC,GAGA,KAGAV,aAAAS,GACA,IAAAF,EAAAN,KAAAE,aAAAF,KAAAC,OACA,IAAAK,EACA,OAAA,KAEA,IAAAM,EAAAZ,KAWA,OAFAM,EAAAE,EARA,SAAAA,GACAI,EAAAX,SAEAO,IACAI,EAAAX,MAAA,IAMAD,KAAAC,OAAAD,KAAAE,aAAAW,QACAb,KAAAG,YACAH,KAAAG,WAAAK,GAEAR,KAAAC,MAAA,EAEAD,KAAAc,cAAAN,IAGA,sBCHA1C,EAAAD,QA9DA,MACAkC,cAEAC,KAAAe,QAAA,GAEAf,KAAAgB,iBAAA,KAGAjB,aAAAS,GACA,GAAA,GAAAA,EAAAS,QAAAC,QAAA,gBAAA,CACA,IACAC,EADAnB,KAAAe,QAAA,aACA,SACA,IAAA,IAAAK,KAAAD,EACAC,EAAAC,aAAAb,GAEA,OAIA,IAAAc,EAAA,IAAAC,MACA,IACAC,EADAxB,KAAAe,QAAAf,KAAAgB,kBACA,SACA,IAAA,IAAAI,KAAAI,EAAA,CACA,IAAAC,EAAAL,EAAAC,aAAAb,GACAiB,IACAC,QAAAC,IAAA,kBAAAF,EAAAR,SACAK,EAAAf,KAAAkB,IAIA,IAAA,IAAAG,KAAAN,EAEAtB,KAAAqB,aAAAO,GAIA7B,iBAAA8B,EAAAC,GACA9B,KAAAgB,iBAAAc,EAEA,IAAAC,EAAA,GACAA,EAAA,SAAAF,EACA7B,KAAAe,QAAAe,GAAAC,EAGAhC,kBAAA+B,GACA9B,KAAAgB,iBAAA,KACAhB,KAAAe,QAAAe,WACA9B,KAAAe,QAAAe,GAIA/B,gCAAA+B,GACA9B,KAAAgB,iBAAAc,EACA,IACAN,EADAxB,KAAAe,QAAAe,GACA,SACA,IAAA,IAAAV,KAAAI,EACAJ,EAAAY,2BCxDA,IAAAC,EAAmBtE,EAAQ,GA6C3BG,EAAAD,QA5CA,cAAAoE,EACAlC,YAAAzB,GACA4D,MAAA5D,GACA0B,KAAAmC,cAAA,GAGApC,cAAAqC,EAAA5B,GACAR,KAAAmC,cAAAC,GAAA5B,EAGAT,cAAAqC,GACA,OAAApC,KAAAmC,cAAAC,GAGArC,aAAAS,GACA,IAAAF,EAAAN,KAAAE,aAAAF,KAAAC,OACA,IAAAK,EACA,OAAA,KAEA,IAAAM,EAAAZ,KAUA,OAFAM,EAAAE,EAPA,SAAAA,GACAI,EAAAX,SAEAO,IACAI,EAAAX,MAAA,IAKAD,KAAAC,OAAAD,KAAAE,aAAAW,QACAb,KAAAG,YACAH,KAAAG,WAAAK,GAEAR,KAAAC,MAAA,EAGAD,KAAAc,cAAAN,IAIA,wBCzCA,IAAAyB,EAAmBtE,EAAQ,GAE3B0E,GADa1E,EAAQ,GACGA,EAAQ,IAEhC2E,EAAA,EAGA,SAAAC,EAAAC,EAAAV,GACA,IAAAD,EAAA,GAGAY,EAAA,IAAAR,EAAA,aACAQ,EAAAC,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,aAAAI,EAAAS,SACA0B,EAAAnC,KAEKoC,cAAApC,IAELqC,EAAA,YADAC,KAAAC,UAAAvC,MAGAqB,EAAAtB,KAAAkC,GAGA,IAAAO,EAAA,IAAAf,EAAA,kBACAe,EAAAN,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,eAAAI,EAAAS,SAAA,iBAAAT,EAAAS,SAAA,GAAAT,EAAAyC,aAAA,oBACAN,EAAAnC,KAEKkC,cAAA,CAAAlC,EAAAmC,EAAAvC,KACL,iBAAAI,EAAAS,SAAAT,EAAAyC,aAAA,mBAAA,GACAN,EAAAnC,KAEKoC,cAAApC,IAELqC,EAAA,iBADAC,KAAAC,UAAAvC,MAEK0C,iBAAA,CAAA1C,EAAAC,KACLD,EAAA2C,QAAA1C,GACAD,EAAA4C,MAAA,kBACA5C,IAGAqB,EAAAtB,KAAAyC,GAGA,IAAAK,EAAA,IAAAhB,EAAA,kBACAgB,EAAAX,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,eAAAI,EAAAS,UACA0B,EAAAnC,GACA6C,EAAAC,cAAA,IAAA9C,MAEKkC,cAAA,CAAAlC,EAAAmC,EAAAvC,KACL,GAAA,kBAAAI,EAAAS,QAAA,CACA,IAAAsC,EAAA/C,EAAAgD,UAAAH,EAAAI,cAAA,KAAAD,UACAhD,EAAAkD,QAAA,OAAAH,GACAZ,EAAAnC,MAEKoC,cAAApC,IAELqC,EAAA,iBADAC,KAAAC,UAAAvC,MAEK0C,iBAAA,CAAA1C,EAAAC,KACLD,EAAA2C,QAAA1C,GACAD,EAAA4C,MAAA,kBACA5C,IAGAqB,EAAAtB,KAAA8C,GAEA,IAAAM,EAAA,IAAA1B,EAAA,yBACA0B,EAAAjB,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,kBAAAI,EAAAS,SACA0B,EAAAnC,KAEKoC,cAAApC,IAELqC,EAAA,YADAC,KAAAC,UAAAvC,MAGAqB,EAAAtB,KAAAoD,GAGA,IAAAC,EAAA,IAAA3B,EAAA,kBACA2B,EAAAlB,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,WAAAI,EAAAS,SACA0B,EAAAnC,KAEKoC,cAAApC,IAELqC,EAAA,iBADAC,KAAAC,UAAAvC,MAGAqB,EAAAtB,KAAAqD,GAGA,IAAAC,EAAA,IAAA5B,EAAA,oBACA4B,EAAAnB,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,UAAAI,EAAAS,SACA0B,EAAAnC,KAEKoC,cAAApC,IAELqC,EAAA,mBADAC,KAAAC,UAAAvC,MAGAqB,EAAAtB,KAAAsD,GAGArB,EAAAD,iBAAAV,EAAAC,GA6DA,SAAAe,EAAAlB,EAAAmC,GACA,GAAAxB,EACAZ,QAAAC,IAAAA,GAEAoC,eAAAlB,cAAAlB,EAAAmC,GATAhG,EAAAD,QAAA,CACA0E,iBAAAA,EACAyB,sBAvDA,SAAAxB,GACA,IAAAX,EAAA,GAGAoC,EAAA,IAAAhC,EAAA,4BACAgC,EAAAvB,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,wBAAAI,EAAAS,SACA0B,EAAAnC,KAEKoC,cAAApC,IAEL+B,EAAAC,EAAAhC,EAAA0D,kBAEArC,EAAAtB,KAAA0D,GAGA,IAAAE,EAAA,IAAAlC,EAAA,2BACAkC,EAAAzB,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,2BAAAI,EAAAS,SACA0B,EAAAnC,KAEKoC,cAAApC,IAELgC,EAAA2B,kBAAA3D,EAAA0D,kBAEArC,EAAAtB,KAAA4D,GAGA,IAAAC,EAAA,IAAAnC,EAAA,2BACAmC,EAAA1B,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,iCAAAI,EAAAS,SACA0B,EAAAnC,KAEKoC,cAAApC,IACL+B,EAAAC,EAAAhC,EAAA0D,kBAEArC,EAAAtB,KAAA6D,GAGA,IAAAC,EAAA,IAAApC,EAAA,kBACAoC,EAAA3B,cAAA,CAAAlC,EAAAmC,EAAAvC,KACA,wBAAAI,EAAAS,SACA0B,EAAAnC,KAEKoC,cAAApC,IACLgC,EAAA8B,gCAAA9D,EAAA0D,kBAEArC,EAAAtB,KAAA8D,GAGA7B,EAAAD,iBAAAV,EAAA,mCC5JAlE,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,kBCgDRG,EAAAD,QArDA,MACAkC,YAAA+B,EAAAyC,EAAAC,EAAAC,EAAAC,GACA1E,KAAA8B,UAAAA,EACA9B,KAAAuE,UAAAA,EACAvE,KAAAwE,KAAAA,EACAxE,KAAAyE,SAAAA,EACAzE,KAAA0E,cAAAA,EAGA3E,QACA,OAAAC,KAAAuE,UAGAxE,MAAAwE,GACAvE,KAAAuE,UAAAA,EAGAxE,UACA,OAAAC,KAAAwE,KAGAzE,QAAAyE,GACAxE,KAAAwE,KAAAA,EAGAzE,aAAAT,GACA,OAAAU,KAAA0E,cAAApF,GAIAS,aAAAT,EAAAN,GACAgB,KAAA0E,cAAApF,GAAAN,EAGAe,QAAAT,GACA,OAAAU,KAAAyE,SAAAnF,GAIAS,QAAAT,EAAAN,GACAgB,KAAAyE,SAAAnF,GAAAN,EAGAe,eACA,OAAAC,KAAA8B,UAGA/B,aAAA+B,GACA9B,KAAA8B,UAAAA,kDChDA,IAAA6C,WAAiBhH,oBAAQ,GACzBiH,aAAmBjH,oBAAQ,GAE3B6E,OAAA,IAAAmC,WACAE,OAAA,EAEA,SAAAC,UAAAtE,OACA,IAAAuE,KAEAA,KADA,GAAAF,OACAG,KAAAxE,OAEAsC,KAAAnC,MAAAH,OAEA,IAAAyE,WAAA,IAAAC,MAAAH,KAAAjD,UAAAiD,KAAAR,UAAAQ,KAAAP,KAAAO,KAAAN,SAAAM,KAAAL,eACAlC,OAAAnB,aAAA4D,YAIA,SAAAE,KAAAC,GACAP,OAAAO,EAdAR,aAAAZ,sBAAAxB,QAiBA1E,OAAAD,QAAA,CACAwH,UAAA7C\",\"sourcesContent\":[\" \\t// The module cache\\n \\tvar installedModules = {};\\n\\n \\t// The require function\\n \\tfunction __webpack_require__(moduleId) {\\n\\n \\t\\t// Check if module is in cache\\n \\t\\tif(installedModules[moduleId]) {\\n \\t\\t\\treturn installedModules[moduleId].exports;\\n \\t\\t}\\n \\t\\t// Create a new module (and put it into the cache)\\n \\t\\tvar module = installedModules[moduleId] = {\\n \\t\\t\\ti: moduleId,\\n \\t\\t\\tl: false,\\n \\t\\t\\texports: {}\\n \\t\\t};\\n\\n \\t\\t// Execute the module function\\n \\t\\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\\n\\n \\t\\t// Flag the module as loaded\\n \\t\\tmodule.l = true;\\n\\n \\t\\t// Return the exports of the module\\n \\t\\treturn module.exports;\\n \\t}\\n\\n\\n \\t// expose the modules object (__webpack_modules__)\\n \\t__webpack_require__.m = modules;\\n\\n \\t// expose the module cache\\n \\t__webpack_require__.c = installedModules;\\n\\n \\t// define getter function for harmony exports\\n \\t__webpack_require__.d = function(exports, name, getter) {\\n \\t\\tif(!__webpack_require__.o(exports, name)) {\\n \\t\\t\\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\\n \\t\\t}\\n \\t};\\n\\n \\t// define __esModule on exports\\n \\t__webpack_require__.r = function(exports) {\\n \\t\\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\\n \\t\\t\\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\\n \\t\\t}\\n \\t\\tObject.defineProperty(exports, '__esModule', { value: true });\\n \\t};\\n\\n \\t// create a fake namespace object\\n \\t// mode & 1: value is a module id, require it\\n \\t// mode & 2: merge all properties of value into the ns\\n \\t// mode & 4: return value when already ns object\\n \\t// mode & 8|1: behave like require\\n \\t__webpack_require__.t = function(value, mode) {\\n \\t\\tif(mode & 1) value = __webpack_require__(value);\\n \\t\\tif(mode & 8) return value;\\n \\t\\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\\n \\t\\tvar ns = Object.create(null);\\n \\t\\t__webpack_require__.r(ns);\\n \\t\\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\\n \\t\\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\\n \\t\\treturn ns;\\n \\t};\\n\\n \\t// getDefaultExport function for compatibility with non-harmony modules\\n \\t__webpack_require__.n = function(module) {\\n \\t\\tvar getter = module && module.__esModule ?\\n \\t\\t\\tfunction getDefault() { return module['default']; } :\\n \\t\\t\\tfunction getModuleExports() { return module; };\\n \\t\\t__webpack_require__.d(getter, 'a', getter);\\n \\t\\treturn getter;\\n \\t};\\n\\n \\t// Object.prototype.hasOwnProperty.call\\n \\t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\\n\\n \\t// __webpack_public_path__\\n \\t__webpack_require__.p = \\\"\\\";\\n\\n\\n \\t// Load entry module and return exports\\n \\treturn __webpack_require__(__webpack_require__.s = 4);\\n\",\"class EventTracker {\\n    constructor(name) {\\n        this.name = name;\\n        this.index = 0;\\n        this.descriptions = [];\\n        this.completion = null;\\n        this.breaker = null;\\n        this.resendEventCb = null;\\n    }\\n    addDescriptor(descriptor) {\\n        this.descriptions.push(descriptor);\\n        return this;\\n    }\\n    addBreaker(breaker) {\\n        this.breaker = breaker;\\n        return this;\\n    }\\n    addCompletion(completion) {\\n        this.completion = completion;\\n        return this;\\n    }\\n    addResendEventCb(resendEventCb){\\n        this.resendEventCb = resendEventCb;\\n        return this;\\n    }\\n\\n    reset() {\\n        this.index = 0;\\n    }\\n\\n    onResendEvent(event){\\n        //构建新事件的时间戳\\n        var timestamp = Date.parse(new Date());\\n        if(this.resendEventCb){\\n            let reSentEvent = this.resendEventCb(event, timestamp);\\n            return reSentEvent;\\n        }\\n        return null;\\n    }\\n\\n    receiveEvent(event) {\\n        let descriptor = this.descriptions[this.index];\\n        if(!descriptor){\\n            return null;\\n        }\\n        var self = this;\\n        let fulfill = function(event) {\\n            self.index++;\\n        };\\n        let breaker = (event) => {\\n            self.index = 0;\\n        };\\n\\n//        console.log(descriptor);\\n        descriptor(event, fulfill, breaker);\\n        \\n        if (this.index >= this.descriptions.length) {\\n            if (this.completion) {\\n                this.completion(event);\\n            }\\n            this.index = 0;\\n            //满足条件之后看有没有需要回传的事件\\n            let resendEvent = this.onResendEvent(event);\\n            return resendEvent;\\n        }\\n        return null;\\n    }\\n}\\n\\nmodule.exports = EventTracker;\\n\",\"class EventStream {\\n    constructor() {\\n        // K 维度  V 容器(K     V   )\\n        this.streams = [];\\n        // 记录当前维度\\n        this.currentDimension = null;\\n    }\\n\\n    receiveEvent(event) {\\n        if (event.getId().indexOf(\\\"XEventSystem\\\") == 0) {\\n            let stream = this.streams[\\\"XEventSystem\\\"];\\n            let systemTrackers = stream[\\\"trackers\\\"];\\n            for (let tracker of systemTrackers) {\\n                tracker.receiveEvent(event);\\n            }\\n            return;\\n        }\\n\\n        //tracker回传的事件\\n        var bufferEvents = new Array()\\n        let currentStream = this.streams[this.currentDimension];\\n        let currentTrackers = currentStream[\\\"trackers\\\"];\\n        for (let tracker of currentTrackers) {\\n            let reSendEvent = tracker.receiveEvent(event);\\n            if(reSendEvent){\\n                console.log(\\\"buffer event : \\\" + reSendEvent.getId());\\n                bufferEvents.push(reSendEvent);\\n            }\\n        }\\n\\n        for (let bufferEvent of bufferEvents)\\n        {\\n            this.receiveEvent(bufferEvent);\\n        }\\n    }\\n    \\n    registerTrackers(trackers, dimension) { \\n        this.currentDimension = dimension;\\n        // 存放当前维度所需要的信息及 trackers\\n        var trackerGroup = [];\\n        trackerGroup[\\\"trackers\\\"] = trackers;\\n        this.streams[dimension] = trackerGroup;\\n    }\\n    \\n    unregisterTracker(dimension){\\n        this.currentDimension = null;\\n        if (this.streams[dimension]) {\\n            delete this.streams[dimension];\\n        }\\n    }\\n\\n    changeDimensionAndResetTrackers(dimension) {\\n        this.currentDimension = dimension;\\n        let currentStream = this.streams[dimension];\\n        let currentTrackers = currentStream[\\\"trackers\\\"];\\n        for (let tracker of currentTrackers) {\\n            tracker.reset();\\n        }\\n    }\\n\\n}\\n\\nmodule.exports = EventStream;\\n\",\"var EventTracker = require('./XPTracker.js');\\nclass StashEventTracker extends EventTracker{\\n    constructor(name) {\\n        super(name);\\n        this.stashEventMap = [];\\n    }\\n\\n    putStashEvent(alias, event){\\n        this.stashEventMap[alias] = event;\\n    }\\n\\n    getStashEvent(alias){\\n        return this.stashEventMap[alias];\\n    }\\n\\n    receiveEvent(event) {\\n        let descriptor = this.descriptions[this.index];\\n        if(!descriptor){\\n            return null;\\n        }\\n        var self = this;\\n        let fulfill = function(event) {\\n            self.index++;\\n        };\\n        let breaker = (event) => {\\n            self.index = 0;\\n        };\\n\\n        descriptor(event, fulfill, breaker);\\n        \\n        if (this.index >= this.descriptions.length) {\\n            if (this.completion) {\\n                this.completion(event);\\n            }\\n            this.index = 0;\\n\\n            //满足条件之后看有没有需要回传的事件\\n            let resendEvent = this.onResendEvent(event);\\n//                console.log(resendEvent.getId());\\n            return resendEvent;\\n        }\\n        return null;\\n    }\\n}\\n\\nmodule.exports = StashEventTracker;\\n\",\"var EventTracker = require('./XPTracker.js');\\nvar stream = require('./XPStream');\\nvar StashEventTracker = require('./XPStashTracker');\\n\\nvar isTest = 1;\\n\\n//根据 dimension 注册一组 tracker\\nfunction registerTrackers(stream, dimension){\\n    var trackers = [];\\n\\n     //xpanel曝光\\n    var xpanel_sw_tracker = new EventTracker(\\\"xpanel_sw\\\");\\n    xpanel_sw_tracker.addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"xpanel_sw\\\") {\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n        var jsonData = JSON.stringify(event);\\n        triggerReport(\\\"xpanel_sw\\\", jsonData);\\n    });\\n    trackers.push(xpanel_sw_tracker);\\n\\n    //拉起\\n    var pullup_tracker = new EventTracker(\\\"xpanel_pull_up\\\");\\n    pullup_tracker.addDescriptor((event, fulfill, breaker)=>{\\n        if ((event.getId() == \\\"xpanel_init\\\" || event.getId() == \\\"xpanel_scroll\\\") && event.getEventAttr(\\\"scroll_distance\\\") == 0) {\\n            fulfill(event);\\n        }\\n    }).addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"xpanel_scroll\\\" && event.getEventAttr(\\\"scroll_distance\\\") > 0) {\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n        var jsonData = JSON.stringify(event);\\n        triggerReport(\\\"xpanel_pull_up\\\", jsonData);\\n    }).addResendEventCb((event, timestamp)=>{\\n            event.setTime(timestamp);\\n            event.setId(\\\"xpanel_pull_up\\\");\\n            return event;\\n        }\\n    );\\n    trackers.push(pullup_tracker);\\n\\n    //曝光时长\\n    var xpanel_sw_time_tracker = new StashEventTracker(\\\"xpanel_sw_time\\\");\\n    xpanel_sw_time_tracker.addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"xpanel_keep\\\") {\\n            fulfill(event);\\n            xpanel_sw_time_tracker.putStashEvent(\\\"A\\\", event);\\n        }\\n    }).addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"xpanel_release\\\") {\\n            let duration = event.getTime() - xpanel_sw_time_tracker.getStashEvent(\\\"A\\\").getTime();\\n            event.putAttr(\\\"time\\\", duration);\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n        var jsonData = JSON.stringify(event);\\n        triggerReport(\\\"xpanel_sw_time\\\", jsonData);\\n    }).addResendEventCb((event, timestamp)=>{\\n          event.setTime(timestamp);\\n          event.setId(\\\"xpanel_sw_time\\\");\\n          return event;\\n      }\\n    );\\n    trackers.push(xpanel_sw_time_tracker);\\n\\n    var xpanel_half_reveal_sw_tracker = new EventTracker(\\\"xpanel_half_reveal_sw\\\");\\n    xpanel_half_reveal_sw_tracker.addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"xpanel_half_sw\\\") {\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n        var jsonData = JSON.stringify(event);\\n        triggerReport(\\\"xpanel_sw\\\", jsonData);\\n    });\\n    trackers.push(xpanel_half_reveal_sw_tracker);\\n\\n    // XPanel 卡片点击\\n    var xpanel_card_ck_tracker = new EventTracker(\\\"xpanel_card_ck\\\");\\n    xpanel_card_ck_tracker.addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"card_ck\\\") {\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n         var jsonData = JSON.stringify(event);\\n         triggerReport(\\\"xpanel_card_ck\\\", jsonData);\\n     });\\n    trackers.push(xpanel_card_ck_tracker);\\n    \\n    // XPanel 卡片按钮点击\\n    var xpanel_button_ck_tracker = new EventTracker(\\\"xpanel_button_ck\\\");\\n    xpanel_button_ck_tracker.addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"btn_ck\\\") {\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n        var jsonData = JSON.stringify(event);\\n        triggerReport(\\\"xpanel_button_ck\\\", jsonData);\\n    });\\n    trackers.push(xpanel_button_ck_tracker);\\n\\n    // 注册整组 trackers\\n    stream.registerTrackers(trackers, dimension);\\n}\\n\\nfunction registerSystemTracker(stream){\\n    var trackers = [];\\n    // VC init\\n    //var registerTracker  = new EventTracker(\\\"xevent_trackers_register\\\");\\n    var registerTracker = new EventTracker(\\\"xevent_trackers_register\\\");\\n    registerTracker.addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"XEventSystem_VC_init\\\") {\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n       // 注册 trackers\\n       registerTrackers(stream, event.getDimension())\\n    });\\n    trackers.push(registerTracker);\\n\\n    // VC dealloc\\n    var unregisterTracker  = new EventTracker(\\\"xevent_trackers_dealloc\\\");\\n    unregisterTracker.addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"XEventSystem_VC_dealloc\\\") {\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n       // 销毁 trackers\\n       stream.unregisterTracker(event.getDimension())\\n    });\\n    trackers.push(unregisterTracker);\\n\\n    // 同一个 VC ，场景(dimension)切换\\n    var dimensionChangeTracker  = new EventTracker(\\\"xevent_dimension_change\\\");\\n    dimensionChangeTracker.addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"XEventSystem_dimension_change\\\") {\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n       registerTrackers(stream, event.getDimension())\\n    });\\n    trackers.push(dimensionChangeTracker);\\n\\n    // 切换业务线至未被销毁的 VC\\n    var pushVCTracker  = new EventTracker(\\\"xevent_push_VC\\\");\\n    pushVCTracker.addDescriptor((event, fulfill, breaker)=>{\\n        if (event.getId() == \\\"XEventSystem_push_VC\\\") {\\n            fulfill(event);\\n        }\\n    }).addCompletion((event)=>{\\n       stream.changeDimensionAndResetTrackers(event.getDimension());\\n    });\\n    trackers.push(pushVCTracker);\\n\\n    // 注册 system trackers\\n    stream.registerTrackers(trackers, \\\"XEventSystem\\\");\\n}\\n\\nmodule.exports = {\\n    registerTrackers:registerTrackers,\\n    registerSystemTracker:registerSystemTracker,\\n};\\n\\nfunction triggerReport(log, jsonData) {\\n    if (isTest == 1) {\\n        console.log(log);\\n    } else {\\n        xpEventManager.triggerReport(log, jsonData);\\n    }\\n}\",\"require('./XPTracker.js');\\nrequire('./XPStashTracker.js');\\nrequire('./XPEvent.js');\\nrequire('./XPStream.js');\\nrequire('./XPRegisterTrackers.js');\\nrequire('./XPEventManager.js');\",\"class Event {\\n    constructor(dimension, xpEventId, time, attrsMap, eventAttrsMap) {\\n        this.dimension = dimension;\\n        this.xpEventId = xpEventId;\\n        this.time = time;\\n        this.attrsMap = attrsMap;\\n        this.eventAttrsMap = eventAttrsMap;\\n    }\\n\\n    getId() {\\n    \\treturn this.xpEventId;\\n    }\\n\\n    setId(xpEventId){\\n        this.xpEventId = xpEventId;\\n    }\\n\\n    getTime(){\\n        return this.time;\\n    }\\n\\n    setTime(time) {\\n        this.time = time;\\n    }\\n\\n    getEventAttr(key) {\\n    \\treturn this.eventAttrsMap[key];\\n    }\\n\\n    //放置不需要打点的K V  只记录在Event中\\n    putEventAttr(key, value){\\n        this.eventAttrsMap[key] = value;\\n    }\\n\\n    getAttr(key) {\\n    \\treturn this.attrsMap[key];\\n    }\\n\\n    //放置需要打点的K V\\n    putAttr(key, value){\\n        this.attrsMap[key] = value;\\n    }\\n\\n    getDimension() {\\n        return this.dimension;\\n    }\\n\\n    setDimension(dimension){\\n        this.dimension = dimension;\\n    }\\n\\n}\\n\\nmodule.exports = Event;\\n\",\"var initStream = require('./XPStream');\\nvar initTrackers = require('./XPRegisterTrackers');\\n\\nvar stream = new initStream();\\nvar ostype = 1;\\ninitTrackers.registerSystemTracker(stream);\\nfunction sendEvent(event) {\\n    var objs;\\n    if(ostype == 0){\\n        objs= eval(event);\\n    }else{\\n        objs= JSON.parse(event);\\n    }\\n    var innerEvent = new Event(objs.dimension, objs.xpEventId, objs.time, objs.attrsMap, objs.eventAttrsMap);\\n    stream.receiveEvent(innerEvent)\\n}\\n\\n//区分os\\nfunction init(osType){\\n    ostype = osType;\\n}\\n\\nmodule.exports = {\\n    newStream: stream\\n};\\n\\n\\n\\n\\n\\n\"]}","code":"!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=4)}([function(e,t){e.exports=class{constructor(e){this.name=e,this.index=0,this.descriptions=[],this.completion=null,this.breaker=null,this.resendEventCb=null}addDescriptor(e){return this.descriptions.push(e),this}addBreaker(e){return this.breaker=e,this}addCompletion(e){return this.completion=e,this}addResendEventCb(e){return this.resendEventCb=e,this}reset(){this.index=0}onResendEvent(e){var t=Date.parse(new Date);return this.resendEventCb?this.resendEventCb(e,t):null}receiveEvent(e){let t=this.descriptions[this.index];if(!t)return null;var n=this;return t(e,function(e){n.index++},e=>{n.index=0}),this.index>=this.descriptions.length?(this.completion&&this.completion(e),this.index=0,this.onResendEvent(e)):null}}},function(e,t){e.exports=class{constructor(){this.streams=[],this.currentDimension=null}receiveEvent(e){if(0==e.getId().indexOf(\"XEventSystem\")){let t=this.streams.XEventSystem.trackers;for(let n of t)n.receiveEvent(e);return}var t=new Array;let n=this.streams[this.currentDimension].trackers;for(let r of n){let n=r.receiveEvent(e);n&&(console.log(\"buffer event : \"+n.getId()),t.push(n))}for(let e of t)this.receiveEvent(e)}registerTrackers(e,t){this.currentDimension=t;var n=[];n.trackers=e,this.streams[t]=n}unregisterTracker(e){this.currentDimension=null,this.streams[e]&&delete this.streams[e]}changeDimensionAndResetTrackers(e){this.currentDimension=e;let t=this.streams[e].trackers;for(let e of t)e.reset()}}},function(e,t,n){var r=n(0);e.exports=class extends r{constructor(e){super(e),this.stashEventMap=[]}putStashEvent(e,t){this.stashEventMap[e]=t}getStashEvent(e){return this.stashEventMap[e]}receiveEvent(e){let t=this.descriptions[this.index];if(!t)return null;var n=this;return t(e,function(e){n.index++},e=>{n.index=0}),this.index>=this.descriptions.length?(this.completion&&this.completion(e),this.index=0,this.onResendEvent(e)):null}}},function(e,t,n){var r=n(0),s=(n(1),n(2)),i=1;function o(e,t){var n=[],i=new r(\"xpanel_sw\");i.addDescriptor((e,t,n)=>{\"xpanel_sw\"==e.getId()&&t(e)}).addCompletion(e=>{a(\"xpanel_sw\",JSON.stringify(e))}),n.push(i);var o=new r(\"xpanel_pull_up\");o.addDescriptor((e,t,n)=>{\"xpanel_init\"!=e.getId()&&\"xpanel_scroll\"!=e.getId()||0!=e.getEventAttr(\"scroll_distance\")||t(e)}).addDescriptor((e,t,n)=>{\"xpanel_scroll\"==e.getId()&&e.getEventAttr(\"scroll_distance\")>0&&t(e)}).addCompletion(e=>{a(\"xpanel_pull_up\",JSON.stringify(e))}).addResendEventCb((e,t)=>(e.setTime(t),e.setId(\"xpanel_pull_up\"),e)),n.push(o);var d=new s(\"xpanel_sw_time\");d.addDescriptor((e,t,n)=>{\"xpanel_keep\"==e.getId()&&(t(e),d.putStashEvent(\"A\",e))}).addDescriptor((e,t,n)=>{if(\"xpanel_release\"==e.getId()){let n=e.getTime()-d.getStashEvent(\"A\").getTime();e.putAttr(\"time\",n),t(e)}}).addCompletion(e=>{a(\"xpanel_sw_time\",JSON.stringify(e))}).addResendEventCb((e,t)=>(e.setTime(t),e.setId(\"xpanel_sw_time\"),e)),n.push(d);var p=new r(\"xpanel_half_reveal_sw\");p.addDescriptor((e,t,n)=>{\"xpanel_half_sw\"==e.getId()&&t(e)}).addCompletion(e=>{a(\"xpanel_sw\",JSON.stringify(e))}),n.push(p);var l=new r(\"xpanel_card_ck\");l.addDescriptor((e,t,n)=>{\"card_ck\"==e.getId()&&t(e)}).addCompletion(e=>{a(\"xpanel_card_ck\",JSON.stringify(e))}),n.push(l);var c=new r(\"xpanel_button_ck\");c.addDescriptor((e,t,n)=>{\"btn_ck\"==e.getId()&&t(e)}).addCompletion(e=>{a(\"xpanel_button_ck\",JSON.stringify(e))}),n.push(c),e.registerTrackers(n,t)}function a(e,t){1==i?console.log(e):xpEventManager.triggerReport(e,t)}e.exports={registerTrackers:o,registerSystemTracker:function(e){var t=[],n=new r(\"xevent_trackers_register\");n.addDescriptor((e,t,n)=>{\"XEventSystem_VC_init\"==e.getId()&&t(e)}).addCompletion(t=>{o(e,t.getDimension())}),t.push(n);var s=new r(\"xevent_trackers_dealloc\");s.addDescriptor((e,t,n)=>{\"XEventSystem_VC_dealloc\"==e.getId()&&t(e)}).addCompletion(t=>{e.unregisterTracker(t.getDimension())}),t.push(s);var i=new r(\"xevent_dimension_change\");i.addDescriptor((e,t,n)=>{\"XEventSystem_dimension_change\"==e.getId()&&t(e)}).addCompletion(t=>{o(e,t.getDimension())}),t.push(i);var a=new r(\"xevent_push_VC\");a.addDescriptor((e,t,n)=>{\"XEventSystem_push_VC\"==e.getId()&&t(e)}).addCompletion(t=>{e.changeDimensionAndResetTrackers(t.getDimension())}),t.push(a),e.registerTrackers(t,\"XEventSystem\")}}},function(e,t,n){n(0),n(2),n(5),n(1),n(3),n(6)},function(e,t){e.exports=class{constructor(e,t,n,r,s){this.dimension=e,this.xpEventId=t,this.time=n,this.attrsMap=r,this.eventAttrsMap=s}getId(){return this.xpEventId}setId(e){this.xpEventId=e}getTime(){return this.time}setTime(e){this.time=e}getEventAttr(e){return this.eventAttrsMap[e]}putEventAttr(e,t){this.eventAttrsMap[e]=t}getAttr(e){return this.attrsMap[e]}putAttr(e,t){this.attrsMap[e]=t}getDimension(){return this.dimension}setDimension(e){this.dimension=e}}},function(module,exports,__webpack_require__){var initStream=__webpack_require__(1),initTrackers=__webpack_require__(3),stream=new initStream,ostype=1;function sendEvent(event){var objs;objs=0==ostype?eval(event):JSON.parse(event);var innerEvent=new Event(objs.dimension,objs.xpEventId,objs.time,objs.attrsMap,objs.eventAttrsMap);stream.receiveEvent(innerEvent)}function init(e){ostype=e}initTrackers.registerSystemTracker(stream),module.exports={newStream:stream}}]);","extractedComments":[]}